(()=>{"use strict";function t(t){return t.xMax-t.xMin}class i{static copy(t){return new i(t.resolution,t.range)}constructor(t,i){this._resolution=t,this._width=t.width,this._height=t.height,this.setRange(i),console.log(`Grid (${this._width} x ${this._height}) created for resolution: ${t.description}`)}updateRange(t){this.setRange(t),console.log(`Grid (${this._width} x ${this._height}) range set to: ${t.xMin} -> ${t.xMax} and yCenter: ${t.yCenter}`)}getIndex(t,i){return i*this._width+t}pixelToMath(t,i){return[this._xMin+t/this.width*this._xDiff,this._yMax-i/this.height*this._yDiff]}mathToPixel(t,i){return[Math.round((t-this._xMin)*this.width/this._xDiff),Math.round((this._yMax-i)*this.height/this._yDiff)]}get resolution(){return this._resolution}get width(){return this._width}get height(){return this._height}get size(){return this._width*this._height}get ratio(){return this._width/this._height}get range(){return this._range}get xDiff(){return this._xDiff}get blueprint(){return{resolution:{width:this._width,height:this.height,description:`${this._resolution.description} (Copy)`},range:this._range}}toString(){return`width: ${this.width}, height:${this.height} -> size ${this.size}`}setRange(i){this._range=i,this._yDiff=t(i)/this.ratio,this._xMin=i.xMin,this._xMax=i.xMax,this._xDiff=t(i),this._yMin=i.yCenter-this._yDiff/2,this._yMax=i.yCenter+this._yDiff/2}}class e extends i{static resolutionWithMargin(t,i){return{width:t.width+2*i,height:t.height+2*i,description:`${t.description} + buffer:${i}`}}static copyWithMargin(t){return new e(t.baseResolution,t.baseRange,t.margin)}constructor(i,h,n){const r=e.resolutionWithMargin(i,n).width/i.width,s=t(h),a=h.xMin+t(h)/2;super(e.resolutionWithMargin(i,n),{xMin:a-s/2*r,xMax:a+s/2*r,yCenter:h.yCenter}),this._baseResolution=i,this._baseRange=h,this._margin=n}getIndexForCenterArea(t,i){return super.getIndex(t+this._margin,i+this._margin)}get margin(){return this._margin}get withMarginBlueprint(){return{baseResolution:{width:this._baseResolution.width,height:this._baseResolution.height,description:`${this._baseResolution.description} (Copy)`},baseRange:this._baseRange,margin:this._margin}}}var h,n,r,s;function a(){return 1-Math.sqrt(1-Math.pow(Math.random(),2))}function o(){return Math.sqrt(1-Math.pow(Math.random()-1,2))}function _(){const t=Math.random();return t<=.5?Math.sqrt(1-Math.pow(2*t-1,2))/2:1-Math.sqrt(1-Math.pow(2*t-1,2))/2}function u(){const t=Math.random();return t<=.5?.5-Math.sqrt(1-Math.pow(2*t,2))/2:.5+Math.sqrt(1-Math.pow(2*t-2,2))/2}function g(){const t=Math.random();return-2*Math.pow(t,3)+3*Math.pow(t,2)}function M(){const t=Math.random();return 6*Math.pow(t,5)-15*Math.pow(t,4)+10*Math.pow(t,3)}function c(){const t=Math.random();return-20*Math.pow(t,7)+70*Math.pow(t,6)-84*Math.pow(t,5)+35*Math.pow(t,4)}function d(){return(1-Math.cos(Math.random()*Math.PI))/2}!function(t){t.START="START"}(h||(h={})),function(t){t.UPDATE="UPDATE",t.RESULT="RESULT"}(n||(n={})),function(t){t[t.DEFAULT=0]="DEFAULT",t[t.ISOLATED=1]="ISOLATED",t[t.ISOLATED_BIG=2]="ISOLATED_BIG"}(r||(r={})),function(t){t[t.LOWER=0]="LOWER",t[t.UPPER=1]="UPPER",t[t.CENTER=2]="CENTER",t[t.BOUNDS=3]="BOUNDS",t[t.BOUNDS_BY_CUBIC=4]="BOUNDS_BY_CUBIC",t[t.BOUNDS_BY_QUINTIC=5]="BOUNDS_BY_QUINTIC",t[t.BOUNDS_BY_SEPTIC=6]="BOUNDS_BY_SEPTIC",t[t.BOUNDS_BY_TRIG=7]="BOUNDS_BY_TRIG"}(s||(s={})),self.onmessage=t=>{const{type:i,data:r}=t.data;if(i===h.START){const t=function(t){const i=e.copyWithMargin(t.gridBlueprint),h=new Float64Array(i.size);let n;switch(t.type){case s.LOWER:n=a;break;case s.UPPER:n=o;break;case s.CENTER:n=_;break;case s.BOUNDS:n=u;break;case s.BOUNDS_BY_CUBIC:n=g;break;case s.BOUNDS_BY_QUINTIC:n=M;break;case s.BOUNDS_BY_SEPTIC:n=c;break;case s.BOUNDS_BY_TRIG:n=d}for(let t=0;t<i.height;t++)for(let e=0;e<i.width;e++)h[i.getIndex(e,t)]=n();return h}(r);self.postMessage({type:n.RESULT,result:t},[t.buffer])}}})();