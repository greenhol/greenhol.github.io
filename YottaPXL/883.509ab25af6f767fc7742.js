(()=>{"use strict";function t(t){return t.xMax-t.xMin}class i{static copy(t){return new i(t.resolution,t.range)}constructor(t,i){this._resolution=t,this._width=t.width,this._height=t.height,this.setRange(i),console.log(`Grid (${this._width} x ${this._height}) created for resolution: ${t.description}`)}updateRange(t){this.setRange(t),console.log(`Grid (${this._width} x ${this._height}) range set to: ${t.xMin} -> ${t.xMax} and yCenter: ${t.yCenter}`)}getIndex(t,i){return i*this._width+t}pixelToMath(t,i){return[this._xMin+t/this.width*this._xDiff,this._yMax-i/this.height*this._yDiff]}mathToPixel(t,i){return[Math.round((t-this._xMin)*this.width/this._xDiff),Math.round((this._yMax-i)*this.height/this._yDiff)]}get resolution(){return this._resolution}get width(){return this._width}get height(){return this._height}get size(){return this._width*this._height}get ratio(){return this._width/this._height}get range(){return this._range}get xDiff(){return this._xDiff}get blueprint(){return{resolution:{width:this._width,height:this.height,description:`${this._resolution.description} (Copy)`},range:this._range}}toString(){return`width: ${this.width}, height:${this.height} -> size ${this.size}`}setRange(i){this._range=i,this._yDiff=t(i)/this.ratio,this._xMin=i.xMin,this._xMax=i.xMax,this._xDiff=t(i),this._yMin=i.yCenter-this._yDiff/2,this._yMax=i.yCenter+this._yDiff/2}}class e extends i{static resolutionWithMargin(t,i){return{width:t.width+2*i,height:t.height+2*i,description:`${t.description} + buffer:${i}`}}static copyWithMargin(t){return new e(t.baseResolution,t.baseRange,t.margin)}constructor(i,h,s){const n=e.resolutionWithMargin(i,s).width/i.width,r=t(h),o=h.xMin+t(h)/2;super(e.resolutionWithMargin(i,s),{xMin:o-r/2*n,xMax:o+r/2*n,yCenter:h.yCenter}),this._baseResolution=i,this._baseRange=h,this._margin=s}getIndexForCenterArea(t,i){return super.getIndex(t+this._margin,i+this._margin)}get margin(){return this._margin}get withMarginBlueprint(){return{baseResolution:{width:this._baseResolution.width,height:this._baseResolution.height,description:`${this._baseResolution.description} (Copy)`},baseRange:this._baseRange,margin:this._margin}}}var h,s;!function(t){t.START="START"}(h||(h={})),function(t){t.UPDATE="UPDATE",t.RESULT="RESULT"}(s||(s={})),self.onmessage=t=>{const{type:i,data:n}=t.data;if(i===h.START){const t=function(t){const i=e.copyWithMargin(t.gridBlueprint),h=new Float64Array(i.size);for(let t=0;t<i.height;t++)for(let e=0;e<i.width;e++)h[i.getIndex(e,t)]=Math.random();return h}(n);self.postMessage({type:s.RESULT,result:t},[t.buffer])}}})();